<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Educational Video Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        textarea, input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .button:active {
            transform: translateY(0);
        }

        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .status.show {
            display: block;
        }

        .status.info {
            background: #e3f2fd;
            color: #1976d2;
            border-left: 4px solid #1976d2;
        }

        .status.success {
            background: #e8f5e9;
            color: #388e3c;
            border-left: 4px solid #388e3c;
        }

        .status.error {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #c62828;
        }

        .progress {
            margin-top: 20px;
            display: none;
        }

        .progress.show {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.5s;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .progress-text {
            margin-top: 10px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }

        .download-section {
            margin-top: 20px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
            display: none;
        }

        .download-section.show {
            display: block;
        }

        .download-button {
            background: #4caf50;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 8px;
            display: inline-block;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .download-button:hover {
            background: #45a049;
        }

        .example-section {
            margin-top: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }

        .example-section h3 {
            margin-bottom: 10px;
            color: #667eea;
        }

        .example {
            padding: 10px;
            background: white;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .example:hover {
            background: #f0f0f0;
        }

        .example-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .example-desc {
            font-size: 0.9em;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸŽ¬ AI Educational Video Generator</h1>
            <p>Transform your ideas into engaging educational videos</p>
        </div>

        <div class="content">
            <form id="videoForm">
                <div class="form-group">
                    <label for="apiKey">OpenAI API Key</label>
                    <input type="text" id="apiKey" placeholder="sk-..." required>
                </div>

                <div class="form-group">
                    <label for="elevenlabsKey">ElevenLabs API Key</label>
                    <input type="text" id="elevenlabsKey" placeholder="your-elevenlabs-api-key" required>
                </div>

                <div class="form-group">
                    <label for="projectName">Project Name</label>
                    <input type="text" id="projectName" placeholder="my_educational_video" required>
                </div>

                <div class="form-group">
                    <label for="description">Educational Content Description</label>
                    <textarea id="description" placeholder="Describe the educational content you want to create. Be specific about concepts, visuals, colors, and examples..." required></textarea>
                </div>

                <button type="submit" class="button" id="generateBtn">
                    Generate Video
                </button>
            </form>

            <div class="example-section">
                <h3>ðŸ“š Example Descriptions</h3>
                <div class="example" onclick="fillExample(1)">
                    <div class="example-title">Pythagorean Theorem</div>
                    <div class="example-desc">Visual explanation with right triangle and squares</div>
                </div>
                <div class="example" onclick="fillExample(2)">
                    <div class="example-title">Photosynthesis</div>
                    <div class="example-desc">Step-by-step process with chemical equation</div>
                </div>
                <div class="example" onclick="fillExample(3)">
                    <div class="example-title">Binary Numbers</div>
                    <div class="example-desc">Introduction to binary with conversions</div>
                </div>
            </div>

            <div class="progress" id="progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">Generating video...</div>
            </div>

            <div class="status" id="status"></div>

            <div class="download-section" id="downloadSection">
                <h3>âœ… Video Ready!</h3>
                <p>Your educational video has been generated successfully.</p>
                <a href="#" class="download-button" id="downloadBtn">Download Video</a>
            </div>
        </div>
    </div>

    <script>
        const API_URL = 'http://localhost:5000/api';
        
        const examples = {
            1: {
                name: "pythagorean_theorem",
                description: `Explain the Pythagorean theorem (aÂ² + bÂ² = cÂ²) visually.
Start with a right triangle, label the sides a, b, and c.
Then show squares drawn on each side.
Demonstrate that the area of squares on the two legs equals the area of the square on the hypotenuse.
Include a numerical example: a=3, b=4, c=5.
Use colors: blue for side a, green for side b, red for hypotenuse c.`
            },
            2: {
                name: "photosynthesis",
                description: `Explain photosynthesis in plants step by step:
1. Show sunlight rays hitting a green leaf
2. Zoom into a chloroplast inside the leaf
3. Show CO2 and H2O molecules entering
4. Display the chemical equation: 6CO2 + 6H2O â†’ C6H12O6 + 6O2
5. Show glucose and oxygen being produced

Use green theme for the leaf, yellow for sunlight, blue for water, and red for oxygen.`
            },
            3: {
                name: "binary_numbers",
                description: `Introduce the binary number system:
1. Explain that computers only understand 0s and 1s
2. Show place values in binary: 1, 2, 4, 8, 16, 32, 64, 128
3. Convert decimal 13 to binary step by step
4. Show a few more examples: 5, 10, 25

Use on/off light bulbs to represent 1s and 0s. Make it colorful.`
            }
        };

        function fillExample(num) {
            const example = examples[num];
            document.getElementById('projectName').value = example.name;
            document.getElementById('description').value = example.description;
        }

        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = 'status show ' + type;
        }

        function hideStatus() {
            document.getElementById('status').classList.remove('show');
        }

        function showProgress() {
            document.getElementById('progress').classList.add('show');
        }

        function hideProgress() {
            document.getElementById('progress').classList.remove('show');
        }

        function updateProgress(percent, text) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }

        async function checkStatus(jobId) {
            try {
                const response = await fetch(`${API_URL}/status/${jobId}`);
                const data = await response.json();

                if (data.status === 'completed') {
                    hideProgress();
                    showStatus('Video generated successfully!', 'success');
                    
                    const downloadSection = document.getElementById('downloadSection');
                    downloadSection.classList.add('show');
                    
                    const downloadBtn = document.getElementById('downloadBtn');
                    downloadBtn.href = `${API_URL}/download/${jobId}`;
                    
                    document.getElementById('generateBtn').disabled = false;
                    return true;
                } else if (data.status === 'failed') {
                    hideProgress();
                    showStatus('Error: ' + (data.error || 'Unknown error'), 'error');
                    document.getElementById('generateBtn').disabled = false;
                    return true;
                } else {
                    // Still processing
                    const messages = {
                        'queued': 'Your video is queued for processing...',
                        'processing': 'Generating your educational video...'
                    };
                    updateProgress(50, messages[data.status] || 'Processing...');
                    return false;
                }
            } catch (error) {
                console.error('Status check error:', error);
                return false;
            }
        }

        document.getElementById('videoForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const apiKey = document.getElementById('apiKey').value;
            const elevenlabsKey = document.getElementById('elevenlabsKey').value;
            const projectName = document.getElementById('projectName').value;
            const description = document.getElementById('description').value;

            hideStatus();
            document.getElementById('downloadSection').classList.remove('show');
            document.getElementById('generateBtn').disabled = true;
            showProgress();
            updateProgress(10, 'Starting video generation...');

            try {
                const response = await fetch(`${API_URL}/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        openai_api_key: apiKey,
                        elevenlabs_api_key: elevenlabsKey,
                        project_name: projectName,
                        description: description
                    })
                });

                const data = await response.json();

                if (response.ok) {
                    const jobId = data.job_id;
                    updateProgress(20, 'Video generation started...');

                    // Poll for status
                    const pollInterval = setInterval(async () => {
                        const completed = await checkStatus(jobId);
                        if (completed) {
                            clearInterval(pollInterval);
                        }
                    }, 3000);

                } else {
                    hideProgress();
                    showStatus('Error: ' + (data.error || 'Failed to start generation'), 'error');
                    document.getElementById('generateBtn').disabled = false;
                }

            } catch (error) {
                hideProgress();
                showStatus('Error: ' + error.message, 'error');
                document.getElementById('generateBtn').disabled = false;
            }
        });
    </script>
</body>
</html>
